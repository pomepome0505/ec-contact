# Docker Image Scan Findings - ec-contact-app:latest

最終更新: 2026-02-19

## スキャン概要

- イメージ: ec-contact-app:latest (1.33GB)
- OS: Debian GNU/Linux 13 (trixie)
- ベースイメージ: library/php (PHP 8.5)
- 脆弱性総数: 55件 (Critical:1, High:16, Medium:32, Low:5, Unknown:1)
- 修正可能: 1件 (gnutls28 → 3.8.9-3+deb13u2)

## 脆弱性一覧（重要度別）

### Critical (1件)

| CVE | パッケージ | バージョン | CVSS | 修正 |
|-----|-----------|-----------|------|------|
| DEBIAN-CVE-2025-55130 | nodejs | 24.13.1 | 9.1 | なし |

- 概要: Node.js Permissionsモデルにおけるバイパス脆弱性
- 悪用条件: `--experimental-permission` フラグ使用時のみ
- **実質リスク: 低**（本プロジェクトのNode.jsはビルドツール用途のみ）

### High (16件) - 主要なもの

| CVE | パッケージ | CVSS | 概要 |
|-----|-----------|------|------|
| DEBIAN-CVE-2026-0861 | glibc | 8.4 | memalign系関数のアライメント過大値でバッファオーバーフロー |
| DEBIAN-CVE-2026-24882 | gnupg2 | 7.8 | tpm2daemon スタックオーバーフロー |
| DEBIAN-CVE-2026-23949 | jaraco.context / setuptools | 8.6 | jaraco.context の脆弱性 |
| DEBIAN-CVE-2025-55131 | nodejs | 7.1 | バッファ割り当てロジックで未初期化メモリ露出 |
| DEBIAN-CVE-2025-59465 | nodejs | 7.5 | HTTP/2 HEADERSフレームの不正処理でクラッシュ |
| DEBIAN-CVE-2025-59466 | nodejs | 7.5 | スタックオーバーフローエラー処理のバグ |
| DEBIAN-CVE-2026-21637 | nodejs | 7.5 | TLSエラー処理でクラッシュ・機密情報漏洩 |
| DEBIAN-CVE-2025-8194 | python3.13 | 7.5 | tarfileモジュールの欠陥 |
| DEBIAN-CVE-2025-13836 | python3.13 | 7.5 | HTTPレスポンス読み取り時のメモリ問題 |
| DEBIAN-CVE-2025-15281 | glibc | 7.5 | wordexpのメモリ問題 |
| DEBIAN-CVE-2026-0915 | glibc | 7.5 | getnetbyaddr のクラッシュ |
| DEBIAN-CVE-2025-13151 | libtasn1-6 | 7.5 | スタックオーバーフロー |
| DEBIAN-CVE-2025-59375 | expat | 7.5 | 大規模動的メモリ割り当て |
| DEBIAN-CVE-2025-8941 | pam | 7.8 | pam_namespace モジュールの不適切処理 |

### 修正可能な脆弱性 (1件)

| CVE | パッケージ | 現在 | 修正版 |
|-----|-----------|------|--------|
| DSA-6140-1 | gnutls28 | 3.8.9-3+deb13u1 | 3.8.9-3+deb13u2 |

### 本番イメージに含めるべきでないパッケージ

- `vim` (4件の脆弱性): 開発ツール、本番不要
- `gnupg2` (2件の脆弱性): 開発/ビルド時のみ必要な場合を除き本番不要
- `nodejs` (6件): 本番イメージではビルド済みアセットのみ必要

## レイヤー別脆弱性内訳

- Layer 0 (debian): glibc, pam, shadow, sqlite3, util-linux, zlib
- Layer 3 (library/php): curl, gnutls28, libtasn1-6
- Layer 15 (library/php): libxml2
- Layer 24 (自社): expat, gnupg2, jaraco.context, ncurses, nginx, python3.13, setuptools, vim
- Layer 25 (自社): gnupg2 (追加), nodejs
- Layer 29 (自社): vim (追加)

## 推奨アクション

1. **本番Dockerfile作成**: vimやgit等の開発ツールを含まないマルチステージビルドに分離
2. **gnutls28のみ即時修正可能**: `apt-get upgrade libgnutls30t64` でDockerfile内で対応
3. **nodejs 本番除外**: 本番イメージはnpmビルド済みアセットのみをCOPY
4. **定期的なベースイメージ更新**: `docker pull php:8.5-fpm` で上流修正を取り込む
